$default-editor-display: inline-block;
$default-image-text-alignment: bottom;

$resize-handle-width: 10px;
$resize-handle-height: 10px;
$resize-handle-border-width: 1px;
$resize-handle-color: #0096fd;
$resize-border-color: $resize-handle-color;

@mixin box-sizing($box-sizing-arg) {
  -webkit-box-sizing: $box-sizing-arg;
  -moz-box-sizing: $box-sizing-arg;
  box-sizing: $box-sizing-arg;
}

@mixin border-radius($border-radius-arg) {
  -webkit-border-radius: $border-radius-arg;
  -moz-border-radius: $border-radius-arg;
  border-radius: $border-radius-arg;
}

@mixin user-select($user-select-arg) {
  -webkit-user-select: $user-select-arg;
  -moz-user-select: $user-select-arg;
  -ms-user-select: $user-select-arg;
  user-select: $user-select-arg;
}

@mixin set-size($width, $height) {
  width: $width;
  height: $height;
}

@mixin selection {
  ::-moz-selection { @content; }
  ::selection { @content; }
}


// Override atto's atto_control
.atto_control_nullify {
  position: static;
  right: auto;
  bottom: auto;
  display: $default-editor-display;  // Chosen as default since we are in an editor.

  img {
    background-color: transparent;
  }

  &:focus .atto_control,
  &:hover .atto_control {
    display: $default-editor-display;
  }
}

.atto_image_preview {
  width: 100%;
  height: 100%;
  margin-left: auto;
  margin-right: auto;
}
.atto_image_preview_box {
  max-height: 200px;
  margin-bottom: 1em;
  overflow: auto;
}

.editor_atto_content img {
  cursor: pointer;
}

.atto_image_size {
  display: inline-block;

  input[type=checkbox] {
    margin-left: 1em;
    margin-right: 1em;
  }

  input[type=text] {
    width: 3em;
  }

  label {
    display: inline-block;
  }
}

.atto-image-wrapper,
.atto-image-wrapper.atto_control {
  @extend .atto_control_nullify;

  *.atto_control {
    @extend .atto_control_nullify;
  }

  vertical-align: $default-image-text-alignment;

  left: 0px;
  top: 0px;

  position: relative;
  overflow: visible;

  // Makes the height value tidy just in case there are borders.
  @include box-sizing(content-box);
}

// .atto-image-editable-helper-wrapper is the class that is common amongst all
// editable image helpers (e.g resizing, rotating, cropping, and so on).
.atto-image-wrapper > .atto-image-editable-helper-wrapper {
  position: absolute;
}

// Dummy to be placed inside overlay, since we can't have the image
// placed inside.
.atto-image-resize-overlay {
  @extend .atto_control_nullify;

  @include box-sizing(border-box);

  // Just fill the overlay.
  width: 100%;
  height: 100%;

  // Avoid ff image movement.
  @include user-select(none);
  pointer-events: none;
}

.atto-image-resize-overlay-wrapper {
  border: 2px solid $resize-handle-color;

  .yui3-resize-handle-inner {
    background-image: none;  // Override yui's image.
    background-color: $resize-handle-color;
    @include set-size($resize-handle-width, $resize-handle-height);
    border: 1px solid white;
    resize: none;
  }

  .yui3-resize-handle-tr {
    bottom: 0px;
    right: 0px;
  }

  .yui3-resize-handle-br {
    bottom: 0px;
    right: 0px;
  }

  .yui3-resize-handle-tl {
    bottom: 0px;
    right: 0px;
  }

  .yui3-resize-handle-bl {
    bottom: 0px;
    right: 0px;
  }

  .yui3-resize-handle-inner-tl {
    top: -$resize-handle-height/2;
    left: -$resize-handle-width/2;
  }

  .yui3-resize-handle-inner-t {
    top: -$resize-handle-height/2;
  }

  .yui3-resize-handle-inner-tr {
    top: -$resize-handle-height/2;
    right: -$resize-handle-width/2;
  }

  .yui3-resize-handle-inner-r {
    bottom: -$resize-handle-height/2;
    right: -$resize-handle-width/2;
  }

  .yui3-resize-handle-inner-br {
    bottom: -$resize-handle-height/2;
    right: -$resize-handle-width/2;
  }

  .yui3-resize-handle-inner-b {
    bottom: -$resize-handle-height/2;
  }

  .yui3-resize-handle-inner-bl {
    bottom: -$resize-handle-height/2;
    left: -$resize-handle-width/2;
  }

  .yui3-resize-handle-inner-l {
    left: -$resize-handle-width/2;
  }
}

// Add this to DOM elements as class that won't be copied or saved.
.atto-image-helper-hide-until-save {
  display: none;
}

.atto-image-wrapper > img {
  margin: 0px;
  position: absolute;  /* For cropping, so we can offset the image inside the wrapper. */
}

// Don't show the selection.
.atto-image-wrapper,
.atto-image-wrapper * {
  @include selection {
    background: none;
  }
}